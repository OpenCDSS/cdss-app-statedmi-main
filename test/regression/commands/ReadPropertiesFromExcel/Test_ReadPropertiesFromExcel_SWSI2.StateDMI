# Test reading properties from an Excel file:
#  * Use the SWSI (Surface Water Supply Index) template as a test
StartLog(LogFile="Results/Test_ReadPropertiesFromExcel_SWSI2.TSTool.log")
RemoveFile(InputFile="Results/Test_ReadPropertiesFromExcel_SWSI2_out.txt",IfNotFound=Ignore)
ReadPropertiesFromExcel(InputFile="Data\CO-SWSI-Control.xlsx",Worksheet="Config",PropertyCellMap="CurrentMonthDate:E7,CurrentMonth:ExcelTestCurrentMonth,ExcelTestPreviousMonthDate:*,ExcelTestNextMonthDate:*,ExcelTestNRCSForecastPublicationDate:*,ExcelTestDoubleProperty:*,ExcelTestBooleanProperty:*,ExcelTestNullProperty:*,ExcelTestIntegerProperty:*,ExcelTestNumberAsBooleanTrueProperty:*,ExcelTestNumberAsBooleanFalseProperty:*,ExcelTestTextYesAsBooleanTrueProperty:*,ExcelTestTextNoAsBooleanFalseProperty:*,ExcelTestTextTrueAsBooleanTrueProperty:*,ExcelTestTextFalseAsBooleanFalseProperty:*,ExcelTestText1AsBooleanTrueProperty:*,ExcelTestText0AsBooleanFalseProperty:*,ExcelTestTextAsDateTimeProperty:*,ExcelTestCurrentMonthDateText:*,ExcelTestNRCSForecastPublicationDateText:*",BooleanProperties="ExcelTestNumberAsBooleanTrueProperty,ExcelTestNumberAsBooleanFalseProperty,ExcelTestTextYesAsBooleanTrueProperty,ExcelTestTextNoAsBooleanFalseProperty,ExcelTestTextTrueAsBooleanTrueProperty,ExcelTestTextFalseAsBooleanFalseProperty,ExcelTestText1AsBooleanTrueProperty,ExcelTestText0AsBooleanFalseProperty",DateTimeProperties="ExcelTestTextAsDateTimeProperty",IntegerProperties="ExcelTestIntegerProperty")
# Uncomment the following command to regenerate expected results
# WritePropertiesToFile(OutputFile="ExpectedResults/Test_ReadPropertiesFromExcel_SWSI2_out.txt",IncludeProperties="ExcelTest*",FileFormat=NameValue,SortOrder=Ascending)
WritePropertiesToFile(OutputFile="Results/Test_ReadPropertiesFromExcel_SWSI2_out.txt",IncludeProperties="ExcelTest*",FileFormat=NameValue,SortOrder=Ascending)
# Do regression comparison with the expected results - allow 3 different for program version properties and warning level
CompareFiles(InputFile1="ExpectedResults\Test_ReadPropertiesFromExcel_SWSI2_out.txt",InputFile2="Results/Test_ReadPropertiesFromExcel_SWSI2_out.txt",AllowedDiff="3",IfDifferent=Warn)
